---
layout: post
title: Reflection Vector Calculation
date: 2024-10-28 12:00:00
description: Breaking down the mathematics and implementation of reflection vector calculation for graphics programming
tags:
categories:
featured: true
---

## Backstory 

About a month ago, I was interviewed for a graphics programmer position. Among the questions asked was how to calculate the reflection vector of an incident light ray on a surface. Unfortunately, I was a bit nervous during the interview and couldn’t think clearly, so I couldn’t answer the question. Unsurprisingly, I didn’t get the position.

Ironically, the solution came to mind shortly after the interview. I took some time to review the math behind it again and decided to write a blog post to break it down.


## Introduction 

In this post, I'll explain the mathematics of calculating the reflection vector given an incident light vector on a surface. Let $$L$$ be the incident light vector at an angle $$\theta$$ from the normal, $$N$$, of the surface, and R be the reflection vector of $$L$$. 

## Law of Reflection

The law of reflection states that the angle of incidence is equal to the angle of reflection. Thus, we know that the reflection angle is also $$\theta$$ from the normal, $$N$$

Suppose $$N$$ and $$L$$ are normalized to unit length.

## Decomposition of Vectors

Each vector has both parallel and perpendicular components relative to $$N$$. 

The parallel component of $$L$$ along $$N$$ is: 

$$
(L.N)N
$$

Alternatively, this can be expressed as $$N cos \theta$$

The perpendicular component of $$L$$ along $$N$$ is: 

$$
L - (L.N)N
$$

## Calculating the Reflection Vector

To compute $$R$$, we reverse the parallel component of $$L$$ along $$N$$ and keep the perpendicular component unchanged:

$$
R = L - 2 (L.N) N
$$


## Implementation in C++
Here’s the C++ code using the GLM library:


```c++
glm::vec3 compute_reflection_vector( glm::vec3 L, glm::vec3 N )
{
    N = glm::normalize(N) ;
    L = glm::normalize(L) ;

    glm::vec3 R = L - 2.0f * glm::dot( L, N ) * N ;

    return R ;
}
```
{% endhighlight %}
